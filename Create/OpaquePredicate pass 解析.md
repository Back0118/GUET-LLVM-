**不透明谓词"是一个在程序执行到某处时，对程序员而言其值必然是已知的表达式。然而，由于某种原因，编译器或者说静态分析器无法推断出这个值，只能在运行时确定，可以作为控制流混淆时的条件生成器，用于构造一些必真或必假的条件，改造目标程序的控制流**

OpaquePredicate 主要实现了使用不透明谓词来改造基本块的控制流，生成分支结构或循环



#### 分支结构的不透明谓词混淆

分支结构的不透明谓词混淆主要是对一些代数上的永真式和永假式进行判断，并将需要执行的指令放入必定跳转到的分支中

##### RandMod

RandMod函数使用以下不透明谓词：

x % z = 1； y % z = 0； (x * y) % z = 0

x,y,z都是随机的整数

##### PrimeOr

PrimeOr函数使用以下不透明谓词：
$$
p1*(x)  !=p2 *(y)
$$
p1p2是两个不相等的素数，x,y是从程序流程中取得的两个数

##### timeop

timeop函数使用以下不透明谓词：

time()1 !=time() 2

time()是c/c++标准函数，time()1,time()2分别是两次调用time函数的返回值



#### 循环结构的不透明谓词混淆

循环结构的不透明谓词混淆主要是对一些迭代的参数进行判断，当参数迭代到符合某项条件后，执行指定的指令，并跳出循环，迭代的过程对程序员而言是必然的

##### Threexplusone

Threexplusone函数参考了数学上的3x+1猜想，对于每一个正整数，如果它是奇数，则对它乘3再加1，如果它是偶数，则对它除以2，如此循环，最终都能够得到1。

Threexplusone先选择一个随机数作为x,对x进行3x+1迭代，当x小于某个随机数时，执行指定的指令，并停止迭代



##### Axplusb

Axplusb函数参考了3x+1猜想在自然数上的推广，对于每一个正整数x,如果它对某个随机数n求余不等于0，则对它乘A再加b,其中n<A<2n,b为某个整数，使得Ax+b对n求余等于0，如果它对n求余等于0，则对它除以n，如此迭代，最终会收敛于某个有理数的循环

Axplusb先选择两个随机数作为x，n，对x进行Ax+b迭代，当x小于某个随机数时，执行指定的指令，并停止迭代



